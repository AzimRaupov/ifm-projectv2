<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSPlumb Example with Line Animation</title>
    <script src="https://cdn.jsdelivr.net/npm/jsplumb@2.15.0/dist/js/jsplumb.min.js"></script>
    <style>
        #container {
            width: 600px;
            height: 400px;
            position: relative;
            border: 1px solid #ccc;
            overflow: auto; /* Добавляем прокрутку */

        }

        .box {
            width: 100px;
            height: 100px;
            position: absolute;
            background-color: #4a90e2;
            color: white;
            text-align: center;
            line-height: 100px;
            border-radius: 8px;
        }

        #box1 {
            top: 50px;
            left: 100px;
        }

        #box2 {
            top: 200px;
            left: 50%;
        }
        #box4 {
            top: 400px;
            left: 50%;
        }
        #box3 {
            top: 50px;
            left: 550px;
        }
        /* CSS для анимации линии */
        path {
            stroke-dasharray: 1000;
            stroke-dashoffset: 1000;
            animation: drawLine 4s ease-in-out forwards;
        }

        /* Ключевая анимация для рисования линии */
        @keyframes drawLine {
            to {
                stroke-dashoffset: 0;
            }
        }
    </style>
</head>
<body>

<div id="container">
    <div id="box1" class="box">Box 1</div>
    <div id="box2" class="box">Box 2</div>
    <div id="box3" class="box">Box 3</div>
    <div id="box4" class="box">Box 4</div>

</div>

<script>
    async function fetchData() {
        try {
            const response = await fetch("{{ route('get.steps', $course->id) }}", {
                method: "POST",
                headers: {
                    "X-CSRF-TOKEN": "{{ csrf_token() }}",
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({}),
            });

            if (!response.ok) {
                throw new Error(`Ошибка HTTP: ${response.status}`);
            }

            const data = await response.json();
            console.log(data);

            create(positionn(data));
        } catch (error) {
            console.error("Ошибка при загрузке шагов курса:", error);
        }
    }
    jsPlumb.ready(function() {
        // Общие настройки для всех соединений
        const commonSettings = {
            connector: ['Bezier'], // Тип соединителя
            paintStyle: { stroke: '#4a90e2', strokeWidth: 2 }, // Цвет линии
            endpoint: 'Dot', // Точка подключения
            endpointStyle: { fill: '#4a90e2', radius: 5 }, // Стиль точек соединения
            overlays: [
                ['Arrow', { location: 1, width: 12, length: 12, direction: 1, paintStyle: { stroke: '#4a90e2', lineWidth: 2 } }]
            ]
        };

        // Массив соединений
        const connections = [
            { source: 'box1', target: 'box2', anchors: ['Bottom', 'Top'] },
            { source: 'box2', target: 'box3', anchors: ['Top', 'Bottom'] },
            { source: 'box2', target: 'box4', anchors: ['Bottom', 'Top'] }
        ];

        // Функция для создания соединений
        function createConnections(connections) {
            connections.forEach(conn => {
                jsPlumb.connect({
                    source: conn.source,
                    target: conn.target,
                    anchors: conn.anchors,
                    ...commonSettings // Подключаем общие настройки
                });
            });
        }

        // Создаем соединения
        createConnections(connections);
    });
</script>
</body>
</html>
